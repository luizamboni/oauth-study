<svg xmlns="http://www.w3.org/2000/svg" width="960" height="420" viewBox="0 0 960 420">
  <rect width="960" height="420" fill="#ffffff"/>
  <style>
    .actor { fill: #f0f4f8; stroke: #1f3a5f; stroke-width: 1.5; }
    .lifeline { stroke: #7b8ba4; stroke-dasharray: 6 6; stroke-width: 1.2; }
    .arrow { stroke: #1976d2; stroke-width: 2; marker-end: url(#arrowhead); fill: none; }
    .arrow-return { stroke: #388e3c; stroke-width: 2; marker-end: url(#arrowhead-return); fill: none; stroke-dasharray: 6 4; }
    .label { font-family: "Helvetica Neue", Arial, sans-serif; font-size: 14px; fill: #1f2a44; }
    .title { font-weight: 600; font-size: 18px; fill: #102542; }
    .step { font-size: 13px; fill: #102542; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1976d2"/>
    </marker>
    <marker id="arrowhead-return" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#388e3c"/>
    </marker>
  </defs>

  <text x="480" y="36" text-anchor="middle" class="title label">Client Credentials Grant (Service-to-Service)</text>

  <!-- Actors -->
  <rect class="actor" x="80" y="70" width="210" height="44" rx="6"/>
  <text class="label" x="185" y="97" text-anchor="middle">Service Client</text>

  <rect class="actor" x="380" y="70" width="200" height="44" rx="6"/>
  <text class="label" x="480" y="97" text-anchor="middle">Keycloak Auth Server</text>

  <rect class="actor" x="670" y="70" width="210" height="44" rx="6"/>
  <text class="label" x="775" y="97" text-anchor="middle">Protected API</text>

  <!-- Lifelines -->
  <line class="lifeline" x1="185" y1="114" x2="185" y2="370"/>
  <line class="lifeline" x1="480" y1="114" x2="480" y2="370"/>
  <line class="lifeline" x1="775" y1="114" x2="775" y2="370"/>

  <!-- Steps -->
  <text class="step" x="185" y="142" text-anchor="middle">1. Load client_id &amp; client_secret</text>

  <text class="step" x="330" y="190">2. POST /token (grant_type=client_credentials)</text>
  <path class="arrow" d="M185 200 C250 200, 320 200, 470 200"/>

  <text class="step" x="330" y="230">3. Client authentication + token issue</text>
  <path class="arrow-return" d="M480 240 C330 240, 260 240, 185 240"/>

  <text class="step" x="510" y="280">4. Call protected resource with Bearer token</text>
  <path class="arrow" d="M185 290 C320 290, 520 290, 765 290"/>

  <text class="step" x="640" y="320">5. Token introspection / verification</text>
  <path class="arrow" d="M775 330 C700 330, 580 330, 490 330"/>

  <text class="step" x="640" y="350">6. Token status + claims response</text>
  <path class="arrow-return" d="M480 340 C570 340, 690 340, 775 340"/>

  <text class="step" x="480" y="380">7. API returns protected data</text>
  <path class="arrow-return" d="M775 360 C570 360, 320 360, 185 360"/>
</svg>
