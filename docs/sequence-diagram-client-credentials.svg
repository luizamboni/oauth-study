<svg xmlns="http://www.w3.org/2000/svg" width="960" height="360" viewBox="0 0 960 360">
  <style>
    .actor { fill: #f5f5f5; stroke: #333; stroke-width: 1.5; }
    .lifeline { stroke: #666; stroke-dasharray: 6 6; stroke-width: 1.2; }
    .arrow { stroke: #1a73e8; stroke-width: 2; marker-end: url(#arrowhead); fill: none; }
    .arrow-return { stroke: #34a853; stroke-width: 2; marker-end: url(#arrowhead); fill: none; stroke-dasharray: 6 4; }
    .label { font-family: "Helvetica Neue", Arial, sans-serif; font-size: 14px; fill: #222; }
    .title { font-weight: bold; font-size: 16px; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1a73e8"/>
    </marker>
  </defs>

  <text x="480" y="28" text-anchor="middle" class="title label">Client Credentials Flow</text>

  <!-- Actors -->
  <rect class="actor" x="120" y="60" width="220" height="40" rx="6"/>
  <text class="label" x="230" y="86" text-anchor="middle">CLI / Service Client</text>
  <rect class="actor" x="420" y="60" width="160" height="40" rx="6"/>
  <text class="label" x="500" y="86" text-anchor="middle">Keycloak</text>
  <rect class="actor" x="700" y="60" width="160" height="40" rx="6"/>
  <text class="label" x="780" y="86" text-anchor="middle">Protected API</text>

  <!-- Lifelines -->
  <line class="lifeline" x1="230" y1="100" x2="230" y2="320"/>
  <line class="lifeline" x1="500" y1="100" x2="500" y2="320"/>
  <line class="lifeline" x1="780" y1="100" x2="780" y2="320"/>

  <!-- Interactions -->
  <text class="label" x="230" y="140" text-anchor="middle">1. Load client_id & secret</text>

  <text class="label" x="480" y="190">2. POST /token (grant_type=client_credentials)</text>
  <path class="arrow" d="M230 200 C280 200, 360 200, 500 200"/>

  <text class="label" x="500" y="240">3. Authenticate client + issue access token</text>
  <path class="arrow-return" d="M500 250 C360 250, 280 250, 230 250"/>

  <text class="label" x="640" y="280">4. Call protected API with Bearer token</text>
  <path class="arrow" d="M230 290 C340 290, 580 290, 780 290"/>

  <text class="label" x="780" y="320">5. API validates token (introspection/JWT)</text>
  <path class="arrow-return" d="M780 310 C580 310, 340 310, 230 310"/>
</svg>
